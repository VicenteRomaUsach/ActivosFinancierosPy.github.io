<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">

<title>quarto-input6ddcf7b1cbc32123</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<pre><code>  
      </code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://portal.usach.cl/sites/default/files/Usach%20P1%20%281%29.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
<pre><code>  
      </code></pre>
<p>Profesor:</p>
<pre><code>      - Carlos Cavieres</code></pre>
<p>Integrantes:</p>
<pre><code>      - Meboly Vega
      
      - Vicente Román
      
      - Luis Gaete
      
      - Felipe Ugalde</code></pre>
<div style="page-break-after: always;">
<div style="page-break-after: always;">

</div>
<section id="introducción-librerias-y-paquetes-a-instalar" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción Librerias y Paquetes a instalar</h1>
<p>El presente informe muestra ejercicios relacionados con ocho activos financieros vistos durante el semestre en la asignatura. El diseño del informe se realizó mediante el motor de Quarto a través de RStudio, donde a su vez se trabajó con el lenguaje de programación Python (fue un desafio traspasar Colab a Rstudio). A continuación (chunk no visible en el informe), se ejecutan las líneas de código correspondientes a la base de funcionamiento del script (instalación de paquetes y librerías necesarias).</p>
<blockquote class="blockquote">
<p><strong>Nota:</strong> Visual Studio Code es capaz de generar un informe a través del código mediante <strong>Ctrl+E</strong> y <strong>Ctrl+Shift+K</strong> (Previsualiza el documento); En caso de que ello no funcione, dentro de Github se encuentra el HTLM siendo este https://vicenteromausach.github.io/ActivosFinancierosPy.github.io/ . de todas maneras se recomienda la ejecución y renderizado en RStudio (tanto en R como en Python) mediante el botón <strong>RENDER</strong> ubicado en la cinta de opciones del archivo .qmd</p>
</blockquote>
</section>
<section id="activo-acciones" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Activo: Acciones</h1>
<p><strong>Definición</strong></p>
<p>Las <strong>acciones</strong> son títulos de propiedad que otorgan a su poseedor una participación proporcional en el capital y en los flujos futuros (dividendos) de una empresa.<br>
El valor teórico de una acción se obtiene descontando al presente los dividendos esperados y, de ser necesario, un valor terminal.</p>
<section id="ejemplo-clases" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="ejemplo-clases"><span class="header-section-number">2.1</span> Ejemplo (Clases)</h2>
<p>La empresa <strong>A</strong> pagará durante los próximos tres años dividendos de $20, $10 y $60.<br>
A partir del cuarto año, los dividendos crecerán indefinidamente al <strong>8 %</strong> anual.</p>
<p>La empresa <strong>B</strong> va a pagar un dividendo de $10 y este crecerá a una tasa constante del <strong>12 %</strong> anual.</p>
<p>La tasa de descuento de mercado es <strong>15 %</strong>.<br>
¿Cuál es el valor actual de la acción de cada empresa?</p>
<p><strong>Fórmulas</strong></p>
<p><strong>Modelo de Gordon‑Shapiro (crecimiento constante)</strong></p>
<p><span class="math display">\[
P_0 = \frac{D_1}{r - g}
\]</span></p>
<p><strong>Modelo de dos etapas (crecimiento no constante seguido de crecimiento perpetuo)</strong></p>
<p><span class="math display">\[
P_0 \;=\; \sum_{t=1}^{t} \frac{D_t}{(1+r)^{n}}
\;+\;
\frac{D_n\,(1+g)}{(r-g)\,(1+r)^{n}}
\]</span></p>
<p>D_t: dividendo en el año t<br>
r: tasa de descuento<br>
g: tasa de crecimiento<br>
n: último año de la etapa explícita</p>
</section>
<section id="código-r" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="código-r"><span class="header-section-number">2.2</span> Código R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DATOS EMPRESA A</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">0.15</span>  <span class="co"># tasa de descuento</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividendos años 1, 2, 3</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>D1_A <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>D2_A <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>D3_A <span class="op">=</span> <span class="dv">60</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>g_A <span class="op">=</span> <span class="fl">0.08</span>  <span class="co"># g = crecimiento perpetuo desde año 4</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor presente de dividendos explícitos</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>vp_dividendos_A <span class="op">=</span> D1_A <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> r)<span class="op">**</span><span class="dv">1</span> <span class="op">+</span> D2_A <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> r)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> D3_A <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> r)<span class="op">**</span><span class="dv">3</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividendo del año 4</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>D4_A <span class="op">=</span> D3_A <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> g_A)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor perpetuo a partir del año 3 (traído a año 0)</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>P3_A <span class="op">=</span> D4_A <span class="op">/</span> (r <span class="op">-</span> g_A)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>vp_terminal_A <span class="op">=</span> P3_A <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> r)<span class="op">**</span><span class="dv">3</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Precio total acción A</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>precio_A <span class="op">=</span> vp_dividendos_A <span class="op">+</span> vp_terminal_A</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># DATOS EMPRESA B</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">0.15</span>  <span class="co"># tasa de descuento</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>D1_B <span class="op">=</span> <span class="dv">10</span>     <span class="co"># dividendo a pagar</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>g_B <span class="op">=</span> <span class="fl">0.12</span>    <span class="co">#  g = crecimiento constante</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividendo año 1 (es el que van a pagar por eso 10)</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>D1_B <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Precio actual con crecimiento constante</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>precio_B <span class="op">=</span> D1_B <span class="op">/</span> (r <span class="op">-</span> g_B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="tabla-de-resultados"><span class="header-section-number">2.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" ===== RESULTADOS ===== "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> ===== RESULTADOS ===== </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EMPRESA A (dividendos mixtos + crecimiento):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>EMPRESA A (dividendos mixtos + crecimiento):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Valor presente de dividendos (años 1–3): $</span><span class="sc">{</span>vp_dividendos_A<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Valor presente de dividendos (años 1–3): $64.40</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Valor presente de perpetuidad desde año 4: $</span><span class="sc">{</span>vp_terminal_A<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Valor presente de perpetuidad desde año 4: $608.67</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Precio estimado de la acción A: $</span><span class="sc">{</span>precio_A<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Precio estimado de la acción A: $673.08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EMPRESA B (crecimiento constante):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>EMPRESA B (crecimiento constante):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Dividendo esperado año 1: $</span><span class="sc">{</span>D1_B<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Dividendo esperado año 1: $10.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Precio estimado de la acción B: $</span><span class="sc">{</span>precio_B<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Precio estimado de la acción B: $333.33</code></pre>
</div>
</div>
</section>
</section>
<section id="gráfico" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="gráfico"><span class="header-section-number">2.3</span> Gráfico</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para reproducibilidad</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">161</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">500</span>            <span class="co"># número de días bursátiles simulados</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">252</span>       <span class="co"># tamaño del paso temporal en años (1 día bursátil)</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.25</span>       <span class="co"># volatilidad anual supuesta</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de Random Walk tipo GBM</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rw_price(P0, mu, sigma, n, dt):</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    eps <span class="op">=</span> np.random.normal(<span class="dv">0</span>, np.sqrt(dt), size<span class="op">=</span>n)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    increments <span class="op">=</span> (mu <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> dt <span class="op">+</span> sigma <span class="op">*</span> eps</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> np.concatenate(([P0], P0 <span class="op">*</span> np.exp(np.cumsum(increments))))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Estilo de gráficos</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"darkgrid"</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">"Set2"</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo: Define aquí tus P0 y drift (g) para las empresas A y B</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>P0_A, gA <span class="op">=</span> <span class="dv">100</span>, <span class="fl">0.10</span>   <span class="co"># precio inicial y drift para Empresa A</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>P0_B, gB <span class="op">=</span> <span class="dv">120</span>, <span class="fl">0.08</span>   <span class="co"># precio inicial y drift para Empresa B</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación de precios</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>price_A <span class="op">=</span> rw_price(P0_A, gA, sigma, n, dt)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>price_B <span class="op">=</span> rw_price(P0_B, gB, sigma, n, dt)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>plt.plot(price_A, label<span class="op">=</span><span class="st">"Empresa A"</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>plt.plot(price_B, label<span class="op">=</span><span class="st">"Empresa B"</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Días"</span>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Precio simulado"</span>)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Random Walk de Precios"</span>)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="resultado-y-conclusión"><span class="header-section-number">2.4</span> Resultado y Conclusión</h2>
<ul>
<li><p><strong>Precio estimado de las acciones</strong></p>
<ul>
<li>Empresa A: $673.08</li>
<li>Empresa B: $333.33</li>
</ul></li>
<li><p><strong>Interpretación</strong></p>
<ul>
<li>La acción <strong>A</strong> vale más debido al gran dividendo explícito de $60 y al crecimiento perpetuo del 8 %.</li>
<li>La acción <strong>B</strong> depende íntegramente del crecimiento constante del 12 %, partiendo de un dividendo menor.</li>
<li>El gráfico muestra trayectorias simuladas: mayores pendientes medias reflejan mayores tasas de crecimiento esperadas, pero ambas series exhiben volatilidad; el inversionista debe ponderar riesgo y retorno antes de decidir.</li>
</ul></li>
</ul>
</section>
</section>
<section id="activo-bonos" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Activo: Bonos</h1>
<p><strong>Definición</strong></p>
<p>Un <strong>bono</strong> es un instrumento de deuda que otorga al tenedor el derecho a recibir pagos de cupón periódicos y la devolución del valor nominal en la fecha de vencimiento.<br>
El precio de un bono corresponde al valor presente de esos flujos de efectivo descontados a la tasa de rendimiento exigida por el mercado.</p>
<section id="ejemplo-clases-1" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="ejemplo-clases-1"><span class="header-section-number">3.1</span> Ejemplo (Clases)</h2>
<p>Un bono con valor nominal de <strong>$1 000</strong> paga cupones anuales de <strong>10 %</strong> durante <strong>10 años</strong>.<br>
Calcule el precio del bono para tres escenarios de tasas de mercado:</p>
<ol type="1">
<li><strong>10%</strong><br>
</li>
<li><strong>12%</strong><br>
</li>
<li><strong>8%</strong></li>
</ol>
<p><strong>Fórmulas</strong></p>
<p><strong>Valor presente del bono</strong></p>
<p><span class="math display">\[ P_0 \;=\; \sum_{t=1}^{n} \frac{C}{(1+r)^{t}} \;+\; \frac{F}{(1+r)^{n}} \]</span> donde</p>
<p>C: tasa cupón<br>
F: valor nominal<br>
n: número de periodos hasta el vencimiento<br>
r: tasa de rendimiento de mercado</p>
<p>Se rescribio la Fórmula de la siguiente manera:</p>
<p><span class="math display">\[
P \;=\;I\!\left[\frac{(1+i)^{n}-1}{i(1+i)^{n}}\right]\;+\;\frac{VN}{(1+i)^{n}}
\]</span> donde<br>
I = cupón anual&nbsp; i = tasa de mercado&nbsp; n = número de períodos&nbsp; VN = valor nominal del bono<br>
</p>
</section>
<section id="código-r-1" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="código-r-1"><span class="header-section-number">3.2</span> Código R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros del bono</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>valor_nominal <span class="op">=</span> <span class="dv">1000</span>       <span class="co"># Valor facial</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>tasa_cupon <span class="op">=</span> <span class="fl">0.10</span>          <span class="co"># 10% anual</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plazo <span class="op">=</span> <span class="dv">10</span>                 <span class="co"># 10 años</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>tasa_descuento <span class="op">=</span> <span class="fl">0.10</span>      <span class="co"># 10% anual</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Flujo de cupones</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>cupon_anual <span class="op">=</span> valor_nominal <span class="op">*</span> tasa_cupon</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el valor presente de cada flujo</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>valores_presentes <span class="op">=</span> []</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, plazo <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    vp_cupon <span class="op">=</span> cupon_anual <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> tasa_descuento)<span class="op">**</span>t</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    valores_presentes.append(vp_cupon)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor presente del valor nominal (principal)</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>vp_principal <span class="op">=</span> valor_nominal <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> tasa_descuento)<span class="op">**</span>plazo</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>valores_presentes.append(vp_principal)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor total del bono</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>valor_bono <span class="op">=</span> <span class="bu">sum</span>(valores_presentes)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros del bono</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>valor_nominal <span class="op">=</span> <span class="dv">1000</span>       <span class="co"># Valor facial</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>tasa_cupon <span class="op">=</span> <span class="fl">0.10</span>          <span class="co"># 10% anual</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>plazo <span class="op">=</span> <span class="dv">10</span>                 <span class="co"># 10 años</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>tasa_descuento <span class="op">=</span> <span class="fl">0.08</span>      <span class="co"># 8% anual</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Flujo de cupones</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>cupon_anual <span class="op">=</span> valor_nominal <span class="op">*</span> tasa_cupon</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el valor presente de cada flujo</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>valores_presentes <span class="op">=</span> []</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, plazo <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    vp_cupon <span class="op">=</span> cupon_anual <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> tasa_descuento)<span class="op">**</span>t</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    valores_presentes.append(vp_cupon)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor presente del valor nominal (principal)</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>vp_principal <span class="op">=</span> valor_nominal <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> tasa_descuento)<span class="op">**</span>plazo</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>valores_presentes.append(vp_principal)</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor total del bono</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>valor_bono_tasa_8 <span class="op">=</span> <span class="bu">sum</span>(valores_presentes)</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros del bono</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>valor_nominal <span class="op">=</span> <span class="dv">1000</span>       <span class="co"># Valor facial</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>tasa_cupon <span class="op">=</span> <span class="fl">0.10</span>          <span class="co"># 10% anual</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>plazo <span class="op">=</span> <span class="dv">10</span>                 <span class="co"># 10 años</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>tasa_descuento <span class="op">=</span> <span class="fl">0.12</span>      <span class="co"># 12% anual</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Flujo de cupones</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>cupon_anual <span class="op">=</span> valor_nominal <span class="op">*</span> tasa_cupon</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el valor presente de cada flujo</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>valores_presentes <span class="op">=</span> []</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, plazo <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>    vp_cupon <span class="op">=</span> cupon_anual <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> tasa_descuento)<span class="op">**</span>t</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>    valores_presentes.append(vp_cupon)</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor presente del valor nominal (principal)</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>vp_principal <span class="op">=</span> valor_nominal <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> tasa_descuento)<span class="op">**</span>plazo</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>valores_presentes.append(vp_principal)</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor total del bono</span></span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>valor_bono_tasa_12 <span class="op">=</span> <span class="bu">sum</span>(valores_presentes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="resultados" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="resultados"><span class="header-section-number">3.2.1</span> Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Valor presente del bono: $</span><span class="sc">{</span>valor_bono<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Valor presente del bono: $1000.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Cuando la tasa de mercado es 12%, El Valor Presente del Bono es : $</span><span class="sc">{</span>valor_bono_tasa_12<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cuando la tasa de mercado es 12%, El Valor Presente del Bono es : $887.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Cuando la tasa de mercado es 8%, El Valor Presente del Bono es : $</span><span class="sc">{</span>valor_bono_tasa_8<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cuando la tasa de mercado es 8%, El Valor Presente del Bono es : $1134.20</code></pre>
</div>
</div>
</section>
</section>
<section id="gráfico-1" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="gráfico-1"><span class="header-section-number">3.3</span> Gráfico</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Función para simular rendimientos como random walk</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_yield_rw(y0, mu, sigma, n, dt):</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">    y0    : rendimiento inicial (en decimal)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">    mu    : drift anual del yield</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">    sigma : volatilidad anual del yield</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">    n     : número de pasos</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">    dt    : tamaño del paso en años (p.ej. 1/252)</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    eps <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, size<span class="op">=</span>n)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    yields <span class="op">=</span> np.empty(n)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    yields[<span class="dv">0</span>] <span class="op">=</span> y0</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        yields[t] <span class="op">=</span> yields[t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> mu<span class="op">*</span>dt <span class="op">+</span> sigma<span class="op">*</span>np.sqrt(dt)<span class="op">*</span>eps[t]</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> yields</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Función de precio de bono tipo cupón</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> precio_bono(yields, cup, vn, n):</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    I <span class="op">=</span> cup <span class="op">*</span> vn</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    pv_coupons   <span class="op">=</span> I <span class="op">*</span> ((<span class="dv">1</span> <span class="op">+</span> yields)<span class="op">**</span>n <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (yields <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> yields)<span class="op">**</span>n)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    pv_principal <span class="op">=</span> vn <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> yields)<span class="op">**</span>n</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pv_coupons <span class="op">+</span> pv_principal</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Parámetros de la simulación</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">161</span>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">500</span>             <span class="co"># días bursátiles</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">252</span>          <span class="co"># paso temporal en años</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>mu_y <span class="op">=</span> <span class="fl">0.0005</span>       <span class="co"># drift diario (aprox 0.5% anual)</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>sigma_y <span class="op">=</span> <span class="fl">0.01</span>      <span class="co"># volatilidad anual</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="fl">0.03</span>           <span class="co"># rendimiento inicial 3%</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>cup_real <span class="op">=</span> <span class="fl">0.03</span>     <span class="co"># cupón 3%</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>vn       <span class="op">=</span> <span class="dv">100</span>      <span class="co"># valor nominal</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>n_real   <span class="op">=</span> <span class="dv">10</span>       <span class="co"># plazo en años</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Simular rendimientos y precios</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>yields_sim <span class="op">=</span> simulate_yield_rw(y0, mu_y, sigma_y, n, dt)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>price_sim  <span class="op">=</span> precio_bono(yields_sim, cup_real, vn, n_real)</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Construir serie temporal con días hábiles</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> pd.bdate_range(start<span class="op">=</span><span class="st">"2020-01-01"</span>, periods<span class="op">=</span>n)</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>price_sim_series <span class="op">=</span> pd.Series(price_sim, index<span class="op">=</span>dates)</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 6) Plot</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>price_sim_series.plot()</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>plt.title(</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Precio implícito de un bono cupón 3%, 10 años</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sobre rendimientos simulados por random walk"</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">""</span>)</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Precio ($)"</span>)</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-1" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="resultado-y-conclusión-1"><span class="header-section-number">3.4</span> Resultado y Conclusión</h2>
<ul>
<li><p><strong>Precio calculado</strong></p>
<ul>
<li>Con rendimiento <strong>10%</strong> : $ 1000</li>
<li>Con rendimiento <strong>12%</strong> : $ 887</li>
<li>Con rendimiento <strong>8%</strong> : $ 1134</li>
</ul></li>
<li><p><strong>Interpretación</strong></p>
<ul>
<li>Si la tasa cupón es igual a la tasa de mercado (10 %), el bono se vende a su valor nominal.</li>
<li>Cuando el rendimiento exigido sube a 12 %, el bono se valora <strong>por debajo</strong> de la par (descuento) porque sus cupones resultan poco atractivos.</li>
<li>A un rendimiento de 8 % el bono se valora <strong>por encima</strong> de la par (prima) ya que sus cupones superan la rentabilidad ofrecida por el mercado.</li>
</ul></li>
</ul>
</section>
</section>
<section id="activo-forward-sobre-tipo-de-cambio" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Activo: Forward sobre tipo de cambio</h1>
<p><strong>Definición</strong></p>
<p>Un <strong>forward</strong> es un contrato a plazo que obliga a las partes a intercambiar un activo (en este caso la divisa) en una fecha futura a un precio pactado hoy.<br>
Para divisas, el <strong>precio forward</strong> se determina por la paridad de intereses entre las dos monedas: el tipo de cambio spot ajustado por las tasas de interés de cada país durante el plazo acordado.</p>
<section id="ejemplo-clases-2" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="ejemplo-clases-2"><span class="header-section-number">4.1</span> Ejemplo (Clases)</h2>
<p>Un importador necesita <strong>1.000.000 USD</strong> dentro de <strong>90 días</strong> para pagar mercadería.<br>
Los datos de mercado son:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Concepto</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Spot compra (CLP/USD)</td>
<td>740</td>
</tr>
<tr class="even">
<td>Spot venta (CLP/USD)</td>
<td>750</td>
</tr>
<tr class="odd">
<td>Tasa CLP colocación (3 meses)</td>
<td>0,9% anual</td>
</tr>
<tr class="even">
<td>Tasa CLP captación (3 meses)</td>
<td>0,8% anual</td>
</tr>
<tr class="odd">
<td>Tasa USD captación (3 meses)</td>
<td>2,3% anual</td>
</tr>
<tr class="even">
<td>Tasa USD colocación (3 meses)</td>
<td>2,4% anual</td>
</tr>
</tbody>
</table>
<p>El importador pacta un <strong>forward de compra</strong> (él compra USD a futuro).<br>
¿Qué tipo de cambio forward deberá pagar y cuál será el costo total en pesos?</p>
<p><strong>Fórmulas</strong></p>
<p><strong>Paridad descubierta de intereses (compra de USD a plazo)</strong></p>
<p><span class="math display">\[F = S_{\text{compra}}
      \,\frac{1 + r_{\text{CLP, col}}\,\dfrac{n}{30}}
             {1 + r_{\text{USD, cap}}\,\dfrac{n}{360}}\]</span></p>
<dl>
<dt>: F: tipo de cambio forward (CLP/USD)</dt>
<dd>
<p>S_compra: tipo de cambio spot de compra (CLP/USD)</p>
</dd>
<dd>
<p>r_CLP,col: tasa de colocación en CLP</p>
</dd>
<dd>
<p>r_USD,cap: tasa de captación en USD</p>
</dd>
<dd>
<p>n: días al vencimiento</p>
</dd>
</dl>
</section>
<section id="código-r-2" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="código-r-2"><span class="header-section-number">4.2</span> Código R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>spot_compra <span class="op">=</span> <span class="dv">740</span>      <span class="co"># CLP por USD</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>r_clp_col   <span class="op">=</span> <span class="fl">0.009</span>    <span class="co"># 0.9 % anual</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>r_usd_cap   <span class="op">=</span> <span class="fl">0.023</span>    <span class="co"># 2.3 % anual</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>n_dias      <span class="op">=</span> <span class="dv">90</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>usd_neces   <span class="op">=</span> <span class="fl">1e6</span>      <span class="co"># 1 000 000 USD</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la tasa forward de compra</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>F_forward <span class="op">=</span> spot_compra <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> r_clp_col <span class="op">*</span> (n_dias <span class="op">/</span> <span class="dv">30</span>)) <span class="op">\</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                        <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> r_usd_cap <span class="op">*</span> (n_dias <span class="op">/</span> <span class="dv">360</span>))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Costo total en CLP si se cubre</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>costo_hedged <span class="op">=</span> usd_neces <span class="op">*</span> F_forward</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="resultados-1" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="resultados-1"><span class="header-section-number">4.2.1</span> Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tasa forward (CLP/USD): </span><span class="sc">{</span>F_forward<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tasa forward (CLP/USD): 755.6351</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Costo total hedgeado (CLP): </span><span class="sc">{</span>costo_hedged<span class="sc">:,.0f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Costo total hedgeado (CLP): 755,635,098</code></pre>
</div>
</div>
</section>
</section>
<section id="gráfico-2" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="gráfico-2"><span class="header-section-number">4.3</span> Gráfico</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>spot_compra <span class="op">=</span> <span class="dv">740</span>      <span class="co"># CLP por USD</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>r_clp_col   <span class="op">=</span> <span class="fl">0.009</span>    <span class="co"># 0.9 % anual</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>r_usd_cap   <span class="op">=</span> <span class="fl">0.023</span>    <span class="co"># 2.3 % anual</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>n_dias      <span class="op">=</span> <span class="dv">90</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>usd_neces   <span class="op">=</span> <span class="fl">1e6</span>      <span class="co"># USD</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de forward y costo hedgeado</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>F_forward <span class="op">=</span> spot_compra <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> r_clp_col <span class="op">*</span> (n_dias <span class="op">/</span> <span class="dv">30</span>)) <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> r_usd_cap <span class="op">*</span> (n_dias <span class="op">/</span> <span class="dv">360</span>))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>costo_hedged <span class="op">=</span> usd_neces <span class="op">*</span> F_forward</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango de spot al vencimiento</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>S_T <span class="op">=</span> np.arange(<span class="dv">700</span>, <span class="dv">801</span>, <span class="dv">1</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>costo_unhedged <span class="op">=</span> usd_neces <span class="op">*</span> S_T</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>plt.plot(S_T, costo_unhedged <span class="op">/</span> <span class="fl">1e9</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Sin cobertura"</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>plt.axhline(costo_hedged <span class="op">/</span> <span class="fl">1e9</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Con forward (costo fijo)"</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>plt.axvline(F_forward, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">"Precio forward"</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Punto de intersección</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>plt.scatter([F_forward], [costo_hedged <span class="op">/</span> <span class="fl">1e9</span>], marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>plt.text(F_forward, costo_hedged <span class="op">/</span> <span class="fl">1e9</span>, <span class="ss">f"</span><span class="sc">{</span>F_forward<span class="sc">:.2f}</span><span class="ss">"</span>, va<span class="op">=</span><span class="st">'bottom'</span>, ha<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Spot al vencimiento (CLP/USD)"</span>)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Costo (miles de millones de CLP)"</span>)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Costo con y sin cobertura forward"</span>)</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-5.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-2" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="resultado-y-conclusión-2"><span class="header-section-number">4.4</span> Resultado y Conclusión</h2>
<ul>
<li><strong>Tipo de cambio forward</strong> pactado: <strong>$755,64 CLP/USD</strong></li>
<li><strong>Costo total</strong> por 1.000.000 USD: <strong>$755.640.000 CLP</strong></li>
</ul>
<p><strong>Interpretación</strong></p>
<ul>
<li>Con el forward, el importador fija su desembolso en 755,64 CLP por dólar; si el spot en 90 días supera ese valor, la cobertura le ahorra dinero.</li>
<li>Si el spot resulta menor, pagará relativamente de más, pero evita la incertidumbre.</li>
<li>La gráfica muestra que el costo sin cobertura crece línea recta con el spot, mientras el costo cubierto se mantiene fijo; esto ilustra la eliminación del riesgo cambiario.</li>
</ul>
</section>
</section>
<section id="activo-fra-forward-rate-agreement" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Activo: FRA (Forward Rate Agreement)</h1>
<p><strong>Definición</strong></p>
<p>Un <strong>FRA</strong> es un acuerdo a plazo que fija hoy el tipo de interés de un préstamo o depósito que comenzará en una fecha futura.<br>
La liquidación se basa en la diferencia entre la tasa de mercado al inicio del periodo protegido y la tasa acordada en el contrato, aplicada al nominal y descontada al valor presente.</p>
<section id="ejemplo-betzuen-2016" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="ejemplo-betzuen-2016"><span class="header-section-number">5.1</span> Ejemplo (Betzuen, (2016))</h2>
<p>Un empresario trata de asegurarse, para dentro de 6 meses, un préstamo a 3 meses, al <strong>3,5%</strong> de interés. Adopta una posición compradora de un <strong>FRA(6/9)</strong>, para un valor nominal de <strong>100.000€</strong> y un tipo garantizado del <strong>3,5%</strong>. El periodo de garantía es de <strong>90 días</strong>. Consideremos dos situaciones totalmente contrarias y comprobemos que se alcanza el objetivo perseguido:</p>
<p><strong>I)</strong> Que al cabo de 6 meses el tipo de interés del mercado, por ejemplo, Euribor a 3 meses, se sitúe en el <strong>4%</strong>.</p>
<p><strong>II)</strong> Que al cabo de 6 meses el tipo de mercado se sitúe en el <strong>3%</strong>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Escenario</th>
<th>Tasa de mercado (i_m)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4,0%</td>
</tr>
<tr class="even">
<td>B</td>
<td>3,0%</td>
</tr>
</tbody>
</table>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
L = \frac{N\,(i_m - i_{FRA})\,\dfrac{t_2}{360}}
         {1 + i_m\,\dfrac{t_2}{360}}
\]</span></p>
<p>donde</p>
<ul>
<li>L: es el pago neto (positivo para el comprador si i_m &gt; i_FRA.<br>
</li>
<li>N: es el nominal del contrato.<br>
</li>
<li>i_m: es la tasa de mercado observada al inicio del periodo protegido.<br>
</li>
<li>i_FRA: es la tasa pactada en el FRA.<br>
</li>
<li>t_2: es la duración del periodo protegido en días.</li>
</ul>
</section>
<section id="código-r-3" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="código-r-3"><span class="header-section-number">5.2</span> Código&nbsp;R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>nominal_fra <span class="op">=</span> <span class="fl">1e5</span>            <span class="co"># € nominal</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>tasa_fra_garantizada <span class="op">=</span> <span class="fl">0.035</span> <span class="co"># 3.5% anual</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="dv">90</span><span class="op">/</span><span class="dv">360</span>                  <span class="co"># periodo de 90 días en años</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tasas de mercado para cada escenario</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>esc <span class="op">=</span> pd.DataFrame({</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Escenario'</span>: [<span class="st">'A (4%)'</span>, <span class="st">'B (3%)'</span>],</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'tasa_mercado'</span>: [<span class="fl">0.04</span>, <span class="fl">0.03</span>]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de liquidación del FRA</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> liquidacion(i_m):</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ( (i_m <span class="op">-</span> tasa_fra_garantizada) </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>             <span class="op">*</span> nominal_fra <span class="op">*</span> dt </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>             <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> i_m <span class="op">*</span> dt) )</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la liquidación para cada escenario</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>esc[<span class="st">'Liquidación_FRA'</span>] <span class="op">=</span> esc[<span class="st">'tasa_mercado'</span>].<span class="bu">apply</span>(liquidacion).<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-1" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="tabla-de-resultados-1"><span class="header-section-number">5.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>esc[[<span class="st">'Escenario'</span>, <span class="st">'Liquidación_FRA'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Escenario  Liquidación_FRA
0    A (4%)           123.76
1    B (3%)          -124.07</code></pre>
</div>
</div>
</section>
</section>
<section id="gráfico-3" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="gráfico-3"><span class="header-section-number">5.3</span> Gráfico</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">1e5</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>i_FRA <span class="op">=</span> <span class="fl">0.035</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="dv">90</span> <span class="op">/</span> <span class="dv">360</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de liquidación</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> liquidacion(i):</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (i <span class="op">-</span> i_FRA) <span class="op">*</span> N <span class="op">*</span> dt <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> i <span class="op">*</span> dt)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango de tasas y payoff</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>rango <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="fl">0.06</span>, <span class="dv">601</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>payoff <span class="op">=</span> liquidacion(rango)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico compacto en Python</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>plt.plot(rango <span class="op">*</span> <span class="dv">100</span>, payoff, color<span class="op">=</span><span class="st">'orange'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>plt.axvline(i_FRA <span class="op">*</span> <span class="dv">100</span>, linestyle<span class="op">=</span><span class="st">':'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Triángulo de área positiva entre 3.5% y 4%</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>plt.fill(</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    [i_FRA <span class="op">*</span> <span class="dv">100</span>, <span class="dv">4</span>, <span class="dv">4</span>],</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>, <span class="dv">0</span>, liquidacion(<span class="fl">0.04</span>)],</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.35</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/curva-fra-7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">1e5</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>i_FRA <span class="op">=</span> <span class="fl">0.035</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="dv">90</span> <span class="op">/</span> <span class="dv">360</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Funciones de liquidación</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>liq      <span class="op">=</span> <span class="kw">lambda</span> i: (i <span class="op">-</span> i_FRA) <span class="op">*</span> N <span class="op">*</span> dt <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> i <span class="op">*</span> dt)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>liq_vend <span class="op">=</span> <span class="kw">lambda</span> i: <span class="op">-</span>liq(i)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango de tasas</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>rango <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="fl">0.06</span>, <span class="dv">601</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>payoff_v <span class="op">=</span> liq_vend(rango)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico compacto</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>plt.plot(rango <span class="op">*</span> <span class="dv">100</span>, payoff_v, color<span class="op">=</span><span class="st">'orange'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>plt.axvline(i_FRA <span class="op">*</span> <span class="dv">100</span>, linestyle<span class="op">=</span><span class="st">':'</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Triángulo de área positiva (i &lt; i_FRA, ej. 3%)</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>x_fra, x_m <span class="op">=</span> i_FRA <span class="op">*</span> <span class="dv">100</span>, <span class="dv">3</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>y_m <span class="op">=</span> liq_vend(<span class="fl">0.03</span>)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>plt.fill([x_fra, x_m, x_m], [<span class="dv">0</span>, <span class="dv">0</span>, y_m], color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.35</span>)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-9.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-3" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="resultado-y-conclusión-3"><span class="header-section-number">5.4</span> Resultado y Conclusión</h2>
<ul>
<li><p><strong>Liquidación del FRA (comprador)</strong></p>
<ul>
<li>EscenarioA (4%): <strong>123,76€</strong> recibe el comprador.</li>
<li>EscenarioB (3%): <strong>–124,07€</strong> paga el comprador (recibe el vendedor).</li>
</ul></li>
</ul>
<p><strong>Interpretación</strong></p>
<ul>
<li>aunque el Euribor suba a 4% el empresario paga efectivamente 3,5% de ínteres.</li>
<li>aunque el Euribor baje a 3$ el empresario paga efectivamente 3,5% de ínteres.</li>
</ul>
</section>
</section>
<section id="activo-futuro-sobre-índice-bursátil" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Activo: Futuro sobre índice bursátil</h1>
<p><strong>Definición</strong></p>
<p>Un <strong>futuro sobre índice</strong> es un contrato estandarizado que obliga a las partes a intercambiar, en una fecha futura, el valor de un índice bursátil al precio pactado hoy.<br>
El precio teórico se obtiene ajustando el nivel spot del índice por la diferencia entre la tasa libre de riesgo y el rendimiento por dividendos esperados durante la vida del contrato.</p>
<section id="ejemplo-hull-2009" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="ejemplo-hull-2009"><span class="header-section-number">6.1</span> Ejemplo (Hull (2009))</h2>
<p>Se pacta hoy <strong>31 de julio</strong> un futuro sobre un índice cuyo nivel spot es <strong>1.300USD</strong>.<br>
Datos:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 61%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Parámetro</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tasa libre de riesgo (continua)</td>
<td>9 % anual</td>
</tr>
<tr class="even">
<td>Meses con dividendos de 5 %</td>
<td>febrero, mayo, agosto, noviembre</td>
</tr>
<tr class="odd">
<td>Meses restantes dividendos de 2 %</td>
<td>enero, marzo, abril, junio, julio, septiembre, octubre, diciembre</td>
</tr>
<tr class="even">
<td>Vencimiento del contrato</td>
<td>31 de diciembre (5 meses)</td>
</tr>
</tbody>
</table>
<p>Durante los <strong>5 meses</strong> de vida del futuro (agosto–diciembre) los rendimientos por dividendos son:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Mes</th>
<th>q</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>agosto</td>
<td>5 %</td>
</tr>
<tr class="even">
<td>septiembre</td>
<td>2 %</td>
</tr>
<tr class="odd">
<td>octubre</td>
<td>2 %</td>
</tr>
<tr class="even">
<td>noviembre</td>
<td>5 %</td>
</tr>
<tr class="odd">
<td>diciembre</td>
<td>2 %</td>
</tr>
</tbody>
</table>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
\bar q = \frac{1}{m}\sum_{i=1}^{m} q_i
\]</span></p>
<p><span class="math display">\[
F_0 = S_0 \, e^{(r - \bar q)\,t}
\]</span></p>
<p>donde</p>
<ul>
<li>q: es la tasa promedio de dividendos durante la vida del contrato.<br>
</li>
<li>S_0: es el nivel spot del índice hoy.<br>
</li>
<li>r: es la tasa libre de riesgo con capitalización continua.<br>
</li>
<li>t: es el tiempo al vencimiento en años.<br>
</li>
<li>F_0: es el precio teórico del futuro.</li>
</ul>
</section>
<section id="código-r-4" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="código-r-4"><span class="header-section-number">6.2</span> Código&nbsp;R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>S0 <span class="op">=</span> <span class="dv">1300</span>          <span class="co"># nivel spot</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>r  <span class="op">=</span> <span class="fl">0.09</span>          <span class="co"># tasa libre de riesgo</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>t  <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">12</span>          <span class="co"># 5 meses en años</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Rendimientos por dividendos de los 5 meses relevantes</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>q_vec <span class="op">=</span> np.array([<span class="fl">0.05</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.05</span>, <span class="fl">0.02</span>])</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>q_bar <span class="op">=</span> q_vec.mean()</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Precio teórico del futuro</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>F0 <span class="op">=</span> S0 <span class="op">*</span> np.exp((r <span class="op">-</span> q_bar) <span class="op">*</span> t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-2" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="tabla-de-resultados-2"><span class="header-section-number">6.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepara las filas</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> [</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"nivel spot (S0)"</span>,               <span class="ss">f"</span><span class="sc">{</span>S0<span class="sc">}</span><span class="ss">"</span>),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"tasa libre de riesgo (r)"</span>,      <span class="ss">f"</span><span class="sc">{</span>r<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"tasa dividendo promedio (q̄)"</span>,  <span class="ss">f"</span><span class="sc">{</span>q_bar<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"plazo (años)"</span>,                  <span class="ss">f"</span><span class="sc">{</span>t<span class="sc">:.4f}</span><span class="ss">"</span>),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"precio futuro (F0)"</span>,            <span class="ss">f"</span><span class="sc">{</span>F0<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprime tabla formateada</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Cálculo del precio futuro"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cálculo del precio futuro</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Variable'</span><span class="sc">:&lt;35}</span><span class="ss"> Valor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variable                            Valor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var, val <span class="kw">in</span> rows:</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>var<span class="sc">:&lt;35}</span><span class="ss"> </span><span class="sc">{</span>val<span class="sc">:&gt;8}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>nivel spot (S0)                         1300
tasa libre de riesgo (r)                9.0%
tasa dividendo promedio (q̄)            3.2%
plazo (años)                          0.4167
precio futuro (F0)                   1331.80</code></pre>
</div>
</div>
</section>
</section>
<section id="gráficos" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="gráficos"><span class="header-section-number">6.3</span> Gráficos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango de precios del futuro al vencimiento</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>F_T <span class="op">=</span> np.arange(F0 <span class="op">-</span> <span class="dv">250</span>, F0 <span class="op">+</span> <span class="dv">251</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>pay <span class="op">=</span> F_T <span class="op">-</span> F0</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="fl">0.6</span>)          <span class="co"># eje horizontal</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>plt.axvline(F0, linestyle<span class="op">=</span><span class="st">':'</span>, linewidth<span class="op">=</span><span class="fl">0.6</span>)          <span class="co"># precio forward asegurado</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>plt.plot(F_T, pay, linewidth<span class="op">=</span><span class="fl">1.5</span>)                      <span class="co"># payoff</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Punto en (F0, 0)</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>plt.scatter([F0], [<span class="dv">0</span>], s<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Flechas y anotaciones</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>plt.annotate(</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Pérdida posición larga'</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    xy<span class="op">=</span>(F0 <span class="op">-</span> <span class="dv">100</span>, <span class="op">-</span><span class="dv">80</span>), xytext<span class="op">=</span>(F0 <span class="op">-</span> <span class="dv">180</span>, <span class="op">-</span><span class="dv">20</span>),</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, linewidth<span class="op">=</span><span class="dv">4</span>))</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>plt.annotate(</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Beneficio posición larga'</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    xy<span class="op">=</span>(F0 <span class="op">+</span> <span class="dv">100</span>, <span class="dv">80</span>), xytext<span class="op">=</span>(F0 <span class="op">+</span> <span class="dv">180</span>, <span class="dv">20</span>),</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, linewidth<span class="op">=</span><span class="dv">4</span>))</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejes y cuadrícula</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>plt.xticks(np.arange(F0 <span class="op">-</span> <span class="dv">250</span>, F0 <span class="op">+</span> <span class="dv">251</span>, <span class="dv">50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>([&lt;matplotlib.axis.XTick object at 0x00000209CF90AA90&gt;, &lt;matplotlib.axis.XTick object at 0x00000209D6C48D90&gt;, &lt;matplotlib.axis.XTick object at 0x00000209CF8F0FD0&gt;, &lt;matplotlib.axis.XTick object at 0x00000209D6CA32D0&gt;, &lt;matplotlib.axis.XTick object at 0x00000209D6CA1A90&gt;, &lt;matplotlib.axis.XTick object at 0x00000209D6CAA750&gt;, &lt;matplotlib.axis.XTick object at 0x00000209D6CB0950&gt;, &lt;matplotlib.axis.XTick object at 0x00000209D6CB2BD0&gt;, &lt;matplotlib.axis.XTick object at 0x00000209D6CB8CD0&gt;, &lt;matplotlib.axis.XTick object at 0x00000209D6CA9ED0&gt;, &lt;matplotlib.axis.XTick object at 0x00000209D6CBB950&gt;], [Text(1081.7993613218425, 0, '1081.8'), Text(1131.7993613218425, 0, '1131.8'), Text(1181.7993613218425, 0, '1181.8'), Text(1231.7993613218425, 0, '1231.8'), Text(1281.7993613218425, 0, '1281.8'), Text(1331.7993613218425, 0, '1331.8'), Text(1381.7993613218425, 0, '1381.8'), Text(1431.7993613218425, 0, '1431.8'), Text(1481.7993613218425, 0, '1481.8'), Text(1531.7993613218425, 0, '1531.8'), Text(1581.7993613218425, 0, '1581.8')])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>plt.yticks(np.arange(<span class="op">-</span><span class="dv">250</span>, <span class="dv">251</span>, <span class="dv">50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>([&lt;matplotlib.axis.YTick object at 0x00000209CF8B9F10&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6C91E90&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6C4AD10&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6CBB050&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6CC2B50&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6CC8CD0&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6CCAE90&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6CCD110&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6CC2090&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6CCFE90&gt;, &lt;matplotlib.axis.YTick object at 0x00000209D6CD9E90&gt;], [Text(0, -250, '−250'), Text(0, -200, '−200'), Text(0, -150, '−150'), Text(0, -100, '−100'), Text(0, -50, '−50'), Text(0, 0, '0'), Text(0, 50, '50'), Text(0, 100, '100'), Text(0, 150, '150'), Text(0, 200, '200'), Text(0, 250, '250')])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Posición Larga – Futuro sobre el índice'</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Precio del futuro al vencimiento (puntos del índice)'</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Beneficio / Pérdida por contrato (puntos)'</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-11.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-4" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="resultado-y-conclusión-4"><span class="header-section-number">6.4</span> Resultado y Conclusión</h2>
<p>El <strong>precio teórico</strong> del futuro con entrega el 31 de diciembre es <strong>$1.331,80USD</strong>.</p>
<ul>
<li>El gráfico muestra que cuanto mayor sea el rendimiento esperado por dividendos, menor será el precio futuro, manteniendo constantes las demás variables.</li>
</ul>
</section>
</section>
<section id="activo-opción-call" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Activo: Opción Call</h1>
<p><strong>Definición</strong></p>
<p>Una <strong>call europea</strong> otorga al comprador el derecho (no la obligación) de comprar un activo subyacente a un <strong>precio de ejercicio</strong> (K) en la fecha de vencimiento.<br>
En un árbol binomial, el precio hoy se obtiene valorando los flujos terminales bajo probabilidad neutral al riesgo y descontándolos a la tasa libre de riesgo.</p>
<section id="ejemplo-clases-3" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="ejemplo-clases-3"><span class="header-section-number">7.1</span> Ejemplo (Clases)</h2>
<p>La acción del Banco de Chile está cotizando en la bolsa a <strong>10 pesos</strong>. Debido a la incertidumbre del mercado financiero, un inversionista supone que el precio podría <strong>aumentar o disminuir en un 20 %</strong> en los próximos <strong>2 años</strong>.</p>
<p>Datos adicionales:</p>
<ul>
<li>Prima de opción: <strong>1,15 pesos</strong></li>
<li>Paquete: <strong>100 acciones</strong></li>
<li>Precio de ejercicio (strike): <strong>8 pesos</strong> (K=8)</li>
<li>Tasa libre de riesgo anual (simple): <strong>11 %</strong></li>
</ul>
<p><strong>A)</strong> Evaluar cuándo se ejerce la opción.</p>
<p><strong>B)</strong> Calcular el precio de una <strong>CALL europea</strong> a 2años.</p>
<p>Datos del contrato:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parámetro</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tasa libre de riesgo (simple)</td>
<td>10 % anual</td>
</tr>
<tr class="even">
<td>Periodos hasta el vencimiento</td>
<td>2 años</td>
</tr>
<tr class="odd">
<td>Factor alza (u)</td>
<td>1,2</td>
</tr>
<tr class="even">
<td>Factor baja (d)</td>
<td>0,8</td>
</tr>
<tr class="odd">
<td>Precio strike (K)</td>
<td>$ 8</td>
</tr>
<tr class="even">
<td>Prima pagada</td>
<td>$ 1,15 por acción</td>
</tr>
<tr class="odd">
<td>Tamaño del lote</td>
<td>100 acciones</td>
</tr>
</tbody>
</table>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
R = 1 + r
\]</span></p>
<p><span class="math display">\[
p = \frac{R - d}{u - d}
\]</span></p>
<p><span class="math display">\[
C = \frac{p\,C_{\text{up}} + (1-p)\,C_{\text{down}}}{python}
\]</span></p>
<p>donde</p>
<ul>
<li>R es el factor de capitalización libre de riesgo.<br>
</li>
<li>p es la probabilidad neutral al riesgo de un movimiento al alza.<br>
</li>
<li>C_up, (C_down son los valores de la opción en los nodos siguientes).</li>
</ul>
</section>
<section id="código-r-5" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="código-r-5"><span class="header-section-number">7.2</span> Código R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>S0      <span class="op">=</span> <span class="dv">10</span>      <span class="co"># precio spot</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>K       <span class="op">=</span> <span class="dv">8</span>       <span class="co"># strike</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>u       <span class="op">=</span> <span class="fl">1.2</span>     <span class="co"># factor alza</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>d       <span class="op">=</span> <span class="fl">0.8</span>     <span class="co"># factor baja</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>r       <span class="op">=</span> <span class="fl">0.10</span>    <span class="co"># tasa libre de riesgo (simple)</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>R       <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> r   <span class="co"># factor de capitalización</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>n       <span class="op">=</span> <span class="dv">2</span>       <span class="co"># pasos</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>premium <span class="op">=</span> <span class="fl">1.15</span>    <span class="co"># prima por acción</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>lote    <span class="op">=</span> <span class="dv">100</span>     <span class="co"># acciones en el paquete</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidad neutral al riesgo</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> (R <span class="op">-</span> d) <span class="op">/</span> (u <span class="op">-</span> d)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Precios en t = 2</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>Suu <span class="op">=</span> S0 <span class="op">*</span> u<span class="op">**</span><span class="dv">2</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>Sud <span class="op">=</span> S0 <span class="op">*</span> u <span class="op">*</span> d</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>Sdd <span class="op">=</span> S0 <span class="op">*</span> d<span class="op">**</span><span class="dv">2</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Payoffs en t = 2</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>Cuu <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, Suu <span class="op">-</span> K)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>Cud <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, Sud <span class="op">-</span> K)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>Cdd <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, Sdd <span class="op">-</span> K)</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Retroceso a t = 1</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>Cu <span class="op">=</span> (p <span class="op">*</span> Cuu <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">*</span> Cud) <span class="op">/</span> R</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>Cd <span class="op">=</span> (p <span class="op">*</span> Cud <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">*</span> Cdd) <span class="op">/</span> R</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Precio presente de la call</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>C0 <span class="op">=</span> (p <span class="op">*</span> Cu <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">*</span> Cd) <span class="op">/</span> R</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>C_paquete <span class="op">=</span> C0 <span class="op">*</span> lote</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Escenarios para el vencimiento</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>S_range <span class="op">=</span> np.arange(<span class="dv">6</span>, <span class="fl">13.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>payoff  <span class="op">=</span> np.maximum(S_range <span class="op">-</span> K, <span class="dv">0</span>) <span class="op">*</span> lote</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>prima   <span class="op">=</span> <span class="op">-</span>premium <span class="op">*</span> lote</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>benef   <span class="op">=</span> payoff <span class="op">+</span> prima</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-3" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="tabla-de-resultados-3"><span class="header-section-number">7.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos base (Se recalcula por incopatibilidad con el entorno de Rstudio)</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>S0      <span class="op">=</span> <span class="dv">10</span>      <span class="co"># precio spot</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>K       <span class="op">=</span> <span class="dv">8</span>       <span class="co"># strike</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>u       <span class="op">=</span> <span class="fl">1.2</span>     <span class="co"># factor alza</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>d       <span class="op">=</span> <span class="fl">0.8</span>     <span class="co"># factor baja</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>r       <span class="op">=</span> <span class="fl">0.10</span>    <span class="co"># tasa libre de riesgo (simple)</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>R       <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> r   <span class="co"># factor de capitalización</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>n       <span class="op">=</span> <span class="dv">2</span>       <span class="co"># pasos</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>premium <span class="op">=</span> <span class="fl">1.15</span>    <span class="co"># prima por acción</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>lote    <span class="op">=</span> <span class="dv">100</span>     <span class="co"># acciones en el paquete</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidad neutral al riesgo</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> (R <span class="op">-</span> d) <span class="op">/</span> (u <span class="op">-</span> d)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Escenarios para el vencimiento y cálculos</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>S_range <span class="op">=</span> np.arange(<span class="dv">6</span>, <span class="fl">13.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>payoff  <span class="op">=</span> np.maximum(S_range <span class="op">-</span> K, <span class="dv">0</span>) <span class="op">*</span> lote</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>prima   <span class="op">=</span> <span class="op">-</span>premium <span class="op">*</span> lote</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>benef   <span class="op">=</span> payoff <span class="op">+</span> prima</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear DataFrame y mostrar solo la tabla</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'precio_final'</span>: S_range,</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'payoff'</span>: payoff,</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'prima'</span>: prima,</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'beneficio'</span>: benef</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.to_string(index<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> precio_final  payoff  prima  beneficio
          6.0     0.0 -115.0     -115.0
          6.5     0.0 -115.0     -115.0
          7.0     0.0 -115.0     -115.0
          7.5     0.0 -115.0     -115.0
          8.0     0.0 -115.0     -115.0
          8.5    50.0 -115.0      -65.0
          9.0   100.0 -115.0      -15.0
          9.5   150.0 -115.0       35.0
         10.0   200.0 -115.0       85.0
         10.5   250.0 -115.0      135.0
         11.0   300.0 -115.0      185.0
         11.5   350.0 -115.0      235.0
         12.0   400.0 -115.0      285.0
         12.5   450.0 -115.0      335.0
         13.0   500.0 -115.0      385.0</code></pre>
</div>
</div>
</section>
</section>
<section id="gráfico-4" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="gráfico-4"><span class="header-section-number">7.3</span> Gráfico</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros de la opción</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>premium <span class="op">=</span> <span class="fl">1.15</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>lote <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango de precios finales y beneficio neto</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>S_range <span class="op">=</span> np.arange(<span class="dv">6</span>, <span class="fl">13.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>payoff <span class="op">=</span> np.maximum(S_range <span class="op">-</span> K, <span class="dv">0</span>) <span class="op">*</span> lote</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>net <span class="op">=</span> payoff <span class="op">-</span> premium <span class="op">*</span> lote</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Puntos de interés</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>breakeven <span class="op">=</span> K <span class="op">+</span> premium</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>x_itm <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>y_itm <span class="op">=</span> np.interp(x_itm, S_range, net)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>x_otm <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>y_otm <span class="op">=</span> np.interp(x_otm, S_range, net)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>plt.plot(S_range, net, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>plt.scatter([breakeven], [<span class="dv">0</span>], s<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>plt.text(breakeven, <span class="dv">0</span>, <span class="st">'At The Money (9.15)'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Anotaciones con flechas</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'In The Money'</span>,</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>             xy<span class="op">=</span>(x_itm, y_itm), xytext<span class="op">=</span>(x_itm <span class="op">-</span> <span class="dv">1</span>, y_itm <span class="op">-</span> <span class="dv">40</span>),</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>             arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, lw<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>             va<span class="op">=</span><span class="st">'top'</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Out The Money'</span>,</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>             xy<span class="op">=</span>(x_otm, y_otm), xytext<span class="op">=</span>(x_otm <span class="op">+</span> <span class="dv">1</span>, y_otm <span class="op">+</span> <span class="dv">40</span>),</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>             arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, lw<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>             va<span class="op">=</span><span class="st">'bottom'</span>, ha<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Etiquetas y título</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Precio de la acción al vencimiento (CLP)'</span>)</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Beneficio neto del lote (CLP)'</span>)</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Pay-off neto – CALL (paquete 100 acciones)'</span>)</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/graf-call-13.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultado-y-conclusión-5" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="resultado-y-conclusión-5"><span class="header-section-number">7.4</span> Resultado y Conclusión</h2>
<ul>
<li><p><strong>Se ejerce la opción</strong> cuando el precio al vencimiento sea <strong>mayor o igual a 8 CLP</strong> (el strike). Por debajo de ese nivel el payoff es cero y el comprador pierde únicamente la prima.</p></li>
<li><p><strong>Precio de la call europea (por acción)</strong>: <strong>$ 3,47</strong> <strong>Valor del paquete (100 acciones)</strong>: <strong>$ 347</strong></p></li>
</ul>
<p><em>La prima de 1,15 CLP representa el desembolso inicial; el comprador necesita que la acción cierre por encima de 9,15 CLP (strike + prima) para obtener ganancia neta.</em></p>
</section>
</section>
<section id="activo-uf" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Activo: UF</h1>
<p><strong>Definición</strong></p>
<p>La <strong>UF</strong> es una unidad indexada a la inflación chilena.<br>
Cada día se actualiza aplicando, de forma proporcional, la variación del IPC del mes anterior.<br>
Del <strong>10 de cada mes</strong> al <strong>9 del mes siguiente</strong> se utiliza el IPC publicado el día 8.</p>
<section id="ejemplo-clase" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="ejemplo-clase"><span class="header-section-number">8.1</span> Ejemplo (Clase)</h2>
<blockquote class="blockquote">
<p><strong>Objetivo</strong>&nbsp;–&nbsp;Estimar la UF del <strong>9 de agosto 2025</strong> a partir de la UF oficial del <strong>16 de junio 2025</strong> (UF = 39220,48).</p>
<p>IPC mayo&nbsp;=&nbsp;+0,2 %<br>
IPC junio&nbsp;=&nbsp;−0,4 %</p>
</blockquote>
<p>Los tramos que intervienen son:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Tramo</th>
<th>Días</th>
<th>IPC aplicado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>16 jun → 9 jul</td>
<td>23&nbsp;días&nbsp;(16 jun–9 jul)</td>
<td>0,2 % (mayo)</td>
</tr>
<tr class="even">
<td>10 jul → 9 ago</td>
<td>21&nbsp;días&nbsp;(10 jul–9 ago)</td>
<td>−0,4 % (junio)</td>
</tr>
</tbody>
</table>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
\text{UF}_t = \text{UF}_{t-1}\;(1 + \text{IPC})^{\tfrac{T}{n}}
\]</span></p>
<p>donde</p>
<ul>
<li>T&nbsp;=&nbsp;número de días transcurridos dentro del periodo.<br>
</li>
<li>n&nbsp;=&nbsp;días del periodo completo (30 para junio, 31 para julio).</li>
</ul>
</section>
<section id="código-r-6" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="código-r-6"><span class="header-section-number">8.2</span> Código&nbsp;R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definición de variables</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>UF_ini <span class="op">=</span> <span class="fl">39230.48</span> <span class="co"># 16 de junio</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>IPC_mayo <span class="op">=</span> <span class="fl">0.002</span> <span class="co"># 0,2 %</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>IPC_jun <span class="op">=</span> <span class="op">-</span><span class="fl">0.004</span> <span class="co"># -0,4 %</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># dias desde la UF conocida hasta el 9 de agosto, por tramo</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>T1 <span class="op">=</span> <span class="dv">23</span> <span class="co"># 16 jun -&gt; 9 jul</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>n1 <span class="op">=</span> <span class="dv">30</span> <span class="co"># junio tiene 30 dias</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>T2 <span class="op">=</span> <span class="dv">31</span> <span class="co"># 10 jul -&gt; 9 ago</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>n2 <span class="op">=</span> <span class="dv">31</span> <span class="co"># julio tiene 31 dias</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculo paso a paso</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>UF_9jul <span class="op">=</span> UF_ini <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> IPC_mayo)<span class="op">**</span>(T1 <span class="op">/</span> n1)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>UF_9ago <span class="op">=</span> UF_9jul <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> IPC_jun)<span class="op">**</span>(T2 <span class="op">/</span> n2)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo a través del método directo (contando un tramo completo)</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>UF_9ago_2 <span class="op">=</span> UF_ini <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> IPC_mayo) <span class="op">**</span> (T1 <span class="op">/</span> n1) <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> IPC_jun) <span class="op">**</span> (T2 <span class="op">/</span> n2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="resultado" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="resultado"><span class="header-section-number">8.2.1</span> Resultado</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"UF al 9 de julio: $</span><span class="sc">{</span><span class="bu">round</span>(UF_9jul, <span class="dv">2</span>)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>UF al 9 de julio: $39,290.62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"UF al 9 de agosto (paso a paso): $</span><span class="sc">{</span><span class="bu">round</span>(UF_9ago, <span class="dv">2</span>)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>UF al 9 de agosto (paso a paso): $39,133.46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"UF al 9 de agosto (método directo): $</span><span class="sc">{</span><span class="bu">round</span>(UF_9ago_2, <span class="dv">2</span>)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>UF al 9 de agosto (método directo): $39,133.46</code></pre>
</div>
</div>
<p>##Gráfico</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos base</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>UF_ini <span class="op">=</span> <span class="fl">39220.48</span>            <span class="co"># 16‑jun‑2025</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>ipc_mayo <span class="op">=</span> <span class="fl">0.002</span>             <span class="co"># +0.2 %</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>ipc_jun <span class="op">=</span> <span class="op">-</span><span class="fl">0.004</span>             <span class="co"># −0.4 %</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cronología de fechas</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> pd.date_range(start<span class="op">=</span><span class="st">"2025-06-16"</span>, end<span class="op">=</span><span class="st">"2025-08-09"</span>, freq<span class="op">=</span><span class="st">"D"</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicializar UF</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>UF <span class="op">=</span> np.empty(<span class="bu">len</span>(dates))</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>UF[<span class="dv">0</span>] <span class="op">=</span> UF_ini</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Crecimiento diario prorrateado</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(dates)):</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    prev <span class="op">=</span> dates[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.Timestamp(<span class="st">"2025-06-10"</span>) <span class="op">&lt;=</span> prev <span class="op">&lt;=</span> pd.Timestamp(<span class="st">"2025-07-09"</span>):</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>        r_daily <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> ipc_mayo)<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">30</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>        r_daily <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> ipc_jun)<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">31</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    UF[i] <span class="op">=</span> UF[i<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> r_daily)</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico</span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>plt.plot(dates, UF)</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Fecha"</span>)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"UF"</span>)</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Variación diaria de la UF (16-jun – 9-ago 2025)"</span>)</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-22-15.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusión" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="conclusión"><span class="header-section-number">8.3</span> Conclusión</h2>
<ol type="1">
<li>La UF al 9 de agosto se obtiene encadenando los factores diarios de inflación correspondientes a los IPC de mayo y junio.</li>
<li>Un IPC mensual negativo hace que la UF baje; en el ejemplo cae desde 39290,61 (9 jul) a 39133,45 (9 ago).</li>
</ol>
</section>
</section>
<section id="activo-modelo-blackscholes-y-paridad-putcall" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Activo: Modelo Black‑Scholes y paridad put‑call</h1>
<p><strong>Definición</strong></p>
<p>El <strong>modelo de Black‑Scholes</strong> valora opciones europeas sobre un activo que no reparte dividendos, suponiendo volatilidad constante y mercado sin fricciones.<br>
El precio de la call (C) y de la put (P) se obtiene a partir de los factores (d_1) y (d_2); luego, la <strong>paridad put‑call</strong> relaciona ambos precios con el subyacente y el strike.</p>
<section id="ejemplo-clases-4" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="ejemplo-clases-4"><span class="header-section-number">9.1</span> Ejemplo (Clases)</h2>
<p>Una acción de <strong>L’Oréal</strong> cotiza a ** (S_0 = 380 ,€)**.<br>
Parámetros del contrato:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Concepto</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Volatilidad (σ)</td>
<td>16 % anual</td>
</tr>
<tr class="even">
<td>Tasa libre de riesgo (r) (continua)</td>
<td>4 % anual</td>
</tr>
<tr class="odd">
<td>Tiempo al vencimiento (T)</td>
<td>2 años</td>
</tr>
<tr class="even">
<td>Strike (K)</td>
<td>378 €</td>
</tr>
</tbody>
</table>
<p>Se pide el <strong>precio de la call y la put europeas</strong> con estos datos.</p>
<p><strong>Fórmulas</strong></p>
<p><span class="math display">\[
d_1 = \frac{\ln(S_0/K) + (r + \sigma^{2}/2)\,T}{\sigma\sqrt{T}}
\qquad
d_2 = d_1 - \sigma\sqrt{T}
\]</span></p>
<p><span class="math display">\[
C = S_0\,N(d_1) - K\,e^{-rT}\,N(d_2)
\qquad
P = K\,e^{-rT}\,N(-d_2) - S_0\,N(-d_1)
\]</span></p>
<p>por paridad también se cumple</p>
<p><span class="math display">\[
P = C + K\,e^{-rT} - S_0
\]</span></p>
<p>N es la función de distribución acumulada de la normal estándar.</p>
</section>
<section id="código-r-7" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="código-r-7"><span class="header-section-number">9.2</span> Código&nbsp;R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> erf(x):</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Constantes de Abramowitz y Stegun Rquarto no me dejó instalar Math ni Stats</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    a1 <span class="op">=</span> <span class="fl">0.254829592</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    a2 <span class="op">=</span> <span class="op">-</span><span class="fl">0.284496736</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    a3 <span class="op">=</span> <span class="fl">1.421413741</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    a4 <span class="op">=</span> <span class="op">-</span><span class="fl">1.453152027</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    a5 <span class="op">=</span> <span class="fl">1.061405429</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    p  <span class="op">=</span> <span class="fl">0.3275911</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    sign <span class="op">=</span> np.sign(x)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    x_abs <span class="op">=</span> np.<span class="bu">abs</span>(x)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> (<span class="fl">1.0</span> <span class="op">+</span> p <span class="op">*</span> x_abs)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Polinomio</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="fl">1.0</span> <span class="op">-</span> (((((a5<span class="op">*</span>t <span class="op">+</span> a4)<span class="op">*</span>t <span class="op">+</span> a3)<span class="op">*</span>t <span class="op">+</span> a2)<span class="op">*</span>t <span class="op">+</span> a1) <span class="op">*</span> t) <span class="op">*</span> np.exp(<span class="op">-</span>x_abs <span class="op">*</span> x_abs)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sign <span class="op">*</span> y</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co"># CDF de la normal estándar</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> norm_cdf(x):</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">0.5</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> erf(x <span class="op">/</span> np.sqrt(<span class="dv">2</span>)))</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>S0, K <span class="op">=</span> <span class="dv">380</span>, <span class="dv">378</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>sigma, r, T <span class="op">=</span> <span class="fl">0.16</span>, <span class="fl">0.04</span>, <span class="fl">2.0</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de d1 y d2</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>d1 <span class="op">=</span> (np.log(S0 <span class="op">/</span> K) <span class="op">+</span> (r <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> T) <span class="op">/</span> (sigma <span class="op">*</span> np.sqrt(T))</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>d2 <span class="op">=</span> d1 <span class="op">-</span> sigma <span class="op">*</span> np.sqrt(T)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Precios por Black–Scholes</span></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>call_price <span class="op">=</span> S0 <span class="op">*</span> norm_cdf(d1) <span class="op">-</span> K <span class="op">*</span> np.exp(<span class="op">-</span>r <span class="op">*</span> T) <span class="op">*</span> norm_cdf(d2)</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>put_price  <span class="op">=</span> K <span class="op">*</span> np.exp(<span class="op">-</span>r <span class="op">*</span> T) <span class="op">*</span> norm_cdf(<span class="op">-</span>d2) <span class="op">-</span> S0 <span class="op">*</span> norm_cdf(<span class="op">-</span>d1)</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>put_parity <span class="op">=</span> call_price <span class="op">+</span> K <span class="op">*</span> np.exp(<span class="op">-</span>r <span class="op">*</span> T) <span class="op">-</span> S0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabla-de-resultados-4" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="tabla-de-resultados-4"><span class="header-section-number">9.2.1</span> Tabla de Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Precio Call:          </span><span class="sc">{</span>call_price<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Precio Call:          50.65</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Precio Put (directa): </span><span class="sc">{</span>put_price<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Precio Put (directa): 19.59</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Precio Put (paridad): </span><span class="sc">{</span>put_parity<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Precio Put (paridad): 19.59</code></pre>
</div>
</div>
</section>
</section>
<section id="resultado-y-conclusión-6" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="resultado-y-conclusión-6"><span class="header-section-number">9.3</span> Resultado y Conclusión</h2>
<ul>
<li><strong>Precio de la call europea</strong>: <strong>50,65 €</strong></li>
<li><strong>Precio de la put europea</strong>: <strong>19,59 €</strong></li>
</ul>
<p>El valor de la put obtenido por fórmula directa coincide con el de la paridad put‑call, validando el cálculo. El precio spot es mayor, comparado con el strike, esto inidca que la call esta in the money.</p>
</section>
</section>
<section id="bibliografia" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Bibliografia</h1>
<ul>
<li><p>Betzuen Zalbidegoitia, A., &amp; Betzuen Álvarez, A. J. (2016). <em>Estrategias de cobertura financiera y de gestión con instrumentos derivados: Tema 1. Instrumento financiero FRA</em>. OCW. </p></li>
<li><p>Hull, J. C. (2009). <em>Introducción a los mercados de futuros y opciones</em> (6.ª ed.). Pearson Educación de México. </p></li>
</ul>
</section>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>